<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css" rel="stylesheet">
    <link rel="stylesheet" href="./styles/tutorial.css">
    <title>Navigation Bar Example</title>
    
</head>

<body>
    <nav>
        <img src="./Images/mongodb-logo-D13D67C930-seeklogo.com.png" alt="">
        <div>
            <button onclick="logout()">Logout</button>
            <a href="sample.html">Sample</a>
        </div>
    </nav>
    <div id="sidebar">
        <a href="#" onclick="showContent('intro')">Intro</a>
        <a href="#" onclick="showContent('benefits')">Benefits</a>
        <a href="#" onclick="showContent('cluster')">Creating a Cluster</a>
        <a href="#" onclick="showContent('connecting')">Connecting to Database</a>
        <a href="#" onclick="showContent('editing')">Editing Data</a>
    </div>

    <main>
        <div id="intro" class="content active">
            <p class="sectionTitle">Introduction</p>
            <hr class="sectionUnderline">
            <div class="imageCont">
                <div class="vertical">
                    <p class="sectionSubTitle">What is MongoDB?</p>
                    <p class="sectionContent imageContent">MongoDB is a document database with the scalability and flexibility that you want with the querying and indexing that you need. It stores data in flexible, JSON-like documents, allowing for data structure to be changed over time. The document model maps to the objects in your application code, making data easy to work with.</p>
                </div>
                <img src="./Images/Mongodb-PNG-Image-HD.png" alt="MongoDB Logo" class="sectionImg" id="mongoDBLogo">
            </div>
            <p class="sectionSubTitle">Why Use MongoDB?</p>
            <p class="sectionContent">MongoDB is very easy to pick up and learn, which makes it perfect for new developers. Due to its ease of use, MongoDB is a very popular database. MongoDB also integrates very well with Nodejs, which is a widely used backend framework, making it ideal for developing projects that require a database storage. Its wide range of benefits, which will be covered in the next section, makes it ideal for developing personal projects.</p>
        </div>

        <div id="benefits" class="content">
            <p class="sectionTitle">Benefits of MongoDB</p>
            <hr class="sectionUnderline">
            <p class="sectionSubTitle">Why Use MongoDB over other Databases?</p>
            <p class="sectionHeader">1. High-performance applications</p>
            <p class="sectionContent">MongoDB's scale-out architecture can support huge numbers of transactions on humongous databases. Unlike other databases that either cannot support such scale or can only do so with massive amounts of engineering and additional components, MongoDB has a clear path to scalability because of the way it was designed.</p>
            <p class="sectionHeader">2. User-friendliness</p>
            <p class="sectionContent">MongoDB is an attractive option to developers. Its data storage philosophy is simple and immediately understandable to
            anybody with programming experience. MongoDB stores data in collections with no enforced schema. This flexible approach to storing data makes it particularly suitable for developers who may not be database experts, yet want to use a database to support the development of their applications.</p>
            <p class="sectionHeader">3. Scalability</p>
            <p class="sectionContent">A key benefit of the MongoDB design is that the database is extremely easy to scale. Configuring a sharded cluster allows a portion of the database, called a shard, to also be configured as a replica set. In a sharded cluster, data is distributed across many servers. This highly flexible approach allows MongoDB to horizontally scale both read and write performance to cater to applications of any scale.</p>
            <p class="sectionHeader">4. Performance</p>
            <p class="sectionContent">MongoDB is also optimized for write performance, and features a specific insertMany() API for rapidly inserting data, prioritizing speed over transaction safety wherein MySQL data needs to be inserted row by row.</p>
            <p class="sectionHeader">5. Flexibility</p>
            <p class="sectionContent">This is an easy one, and a hands-down win for MongoDB. The schemaless design of MongoDB documents makes it extremely easy to build and enhance applications over time, without needing to run complex and expensive schema migration processes as you would with a relational database. With MongoDB, there are more dynamic options for updating the schema of a collection, such as creating new fields based on an aggregation pipeline or updating nested array fields. This benefit is particularly important as databases grow in size.</p>
            <p class="sectionHeader">6. Security</p>
            <p class="sectionContent">MongoDB leverages the popular role-based access control model with a flexible set of permissions. Users are assigned to a role, and that role grants them specific permissions over datasets and database operations. All communication is encrypted with TLS, and it's possible to write encrypted documents to MongoDB data collections using a master key which is never available to MongoDB, achieving encryption of data at rest. Introduced in MongoDB 7.0, Queryable Encryption allows users to apply randomized encryption to sensitive fields, store the encrypted values in the database and run expressive queries against those fields without decrypting them. This allows it to protect sensitive data during its entire lifecycle.</p>
        </div>

        <div id="cluster" class="content">
            <p class="sectionTitle">Creating a Cluster</p>
            <hr class="sectionUnderline">
            <p class="sectionSubTitle">Creating a Cluster on MongoDB</p>
            <iframe src="https://scribehow.com/embed/Create_a_MongoDB_Database__2C8Dp1e6S6iHKFmHXuKoqA" width="100%" height="640" allowfullscreen frameborder="0"></iframe>
        </div>
        </div>

        <div id="connecting" class="content">
            <p class="sectionTitle">Connecting to the Database through Nodejs</p>
            <hr class="sectionUnderline">
            <p class="sectionSubTitle">Linking to Database</p>
            <p class="sectionHeader">1. Getting the Connection String from MongoDB</p>
            <iframe src="https://scribehow.com/embed/Getting_the_MongoDB_Connection_String__39hfoY85QZSmY6Xejfu9ZQ" width="100%" height="640" allowfullscreen frameborder="0"></iframe>
            <p class="sectionHeader">2. Editing the Connection String</p>
            <p class="sectionContent">Once you have the connection string, replace the "< username >" and "< password >" section with the username password that you assigned to the user when you were creating the cluster.</p>
            <p class="sectionHeader">3. Installing Prerequisites</p>
            <p class="sectionContent">Make sure that <a href="https://nodejs.org/" target="_blank">Node.js</a> is installed</p>
            <p class="sectionHeader">4. Installing Necessary Dependencies</p>
            <p class="sectionContent">Initialize a new Node.js project by using "npm init -y" command in the terminal. Then install the necessay dependencies that will be needed to run the code to connect to the database. For this example, the necessary dependencies are express and mongoose.</p>
            <p class="sectionHeader">5. Basic Node.js Express Server</p>
            <p class="sectionContent">The following code is the basic template for creating a simple Node.js express server.</p>
            <div class="codeCont">
                <pre>
                    <code class="sectionContent codeSection language-js">
                        // Import necessary modules
                        const express = require('express');
                        const app = express();
                        const mongoose = require('mongoose');

                        // Routes/router setup
                        // Change route to whatever url you want to be used to access CRUD functions (CRUD is covered in the next section)
                        // Replace filePath with the pathing to file that contains the CRUD functions 
                        app.use(`/${route}`, require(`${filePath}`)); 
                        

                        // Middleware setup
                        // Static assets
                        app.use(express.static('./public'));
                        // Parse form data
                        app.use(express.urlencoded({ extended: false }));
                        // Parse JSON data
                        app.use(express.json());
                        
                        
                        // Server Listen setup
                        const initServer = async () => {
                            try {
                                // Connect to MongoDB using Mongoose
                                await mongoose.connect(`${url}`); // Put your MongoDB connection string in place of the url text
                                // Start the Express server
                                app.listen(5000, () => {
                                    console.log('Server listening on port 5000');
                                });
                            } catch (e) {
                                // Handle database connection error
                                console.error('Error connecting to the database:', e);
                                process.exit(1); // Exit the process if the database connection fails
                            }
                        }
                        
                        // Initialize the server
                        initServer();
                    </code>
                </pre>
            </div>
            <p class="sectionHeader">6. Running the Server</p>
            <p class="sectionContent">Once all the code is ready, you can run the server by using the "node index.js" command in the terminal. Then go to <a href="http://localhost:5000" target="_blank">localhost:5000</a> to access the website.</p>
        </div>

        <div id="editing" class="content">
            <p class="sectionTitle">Editing Data</p>
            <hr class="sectionUnderline">
            <p class="sectionSubTitle">What are Schemas?</p>
            <p class="sectionContent">Schemas are not required by MongoDB as it is has a schemaless design option. However, schemas are templates that are used to structure the data. Here is an example from the sample application:</p>
            <div class="codeCont">
                <pre>
                    <code class="sectionContent codeSection language-js">
                        const mongoose = require('mongoose');
                    
                        const PersonSchema = new mongoose.Schema({
                            username:{
                                // type determines the variable type
                                type: String, 
                                // required determines if the peice of data is required for the data entry or not
                                required: [true, 'Must provide a name'], 
                                // trim will remove whitespace from start and end the string
                                trim: true, 
                            },
                            email:{
                                type: String,
                                required: [true, 'Must provide an email'],
                                trim: true,
                            },
                            password:{
                                type: String,
                                required: [true, 'Must provide a password'],
                            },
                            routines:{
                                type: Array,
                                default: []
                            },
                            userID:{
                                type: Number,
                                default: 0
                            }
                        },{collection: 'Users'}) // specifies which collection in the database to use
                    
                        module.exports = mongoose.model('User', PersonSchema);
                    </code>
                </pre>
            </div>
            <p class="sectionSubTitle">What does CRUD Mean?</p>
            <p class="sectionContent">CRUD stands for Creating, Reading, Updating, and Deleting, which are the 4 main methods of editing MongoDB data.</p>
            <p class="sectionHeader">Creating</p>
            <p class="sectionContent">Creating is used to add data to the database. Below is an example of a create function:</p>
            <div class="codeCont">
                <pre>
                    <code class="sectionContent codeSection language-js">
                        // importing the schema to allow us to interact with the MongoDB database using mongoose
                        const User = require('../models/person');
                        // importing router to be able to define which URLs will call which functions
                        const router = express.Router();

                        // post function for creating people
                        router.post('/people', async(req,res)=>{
                            try {
                                // gets all the data from the User variable
                                let allUser = await User.find({});
                                // gets information from the request body
                                let {username, email, password, routines} = req.body;
                                
                                // creating a simple object
                                routines = {
                                    name: 'arm day',
                                    exercises: [],
                                }
                                
                                // creates a new user object in the MongoDB using the information received in the body
                                let newPerson = await User.create({
                                    username:username, email:email, password:password, routines:routines,userID:allUser.length
                                });
                                // gets all the users now, including the one just created
                                allUser = await User.find({});
                                // returns the data in a response object
                                res.json(allUser);
                            } catch (error) {
                                console.log(error);
                            }
                        })
                    </code>
                </pre>
            </div>
            <p class="sectionContent">Below is an exmaple of calling the create function through a POST fetch request:</p>
            <div class="codeCont">
                <pre>
                    <code class="sectionContent codeSection language-js">
                        // the url defines what route will be called
                        fetch('/',{
                            // determines the type of method that will be used
                            method: 'POST', 
                            //passes information into the body of the request that will be used to create the new piece of data
                            body: JSON.stringify({username: name, email, password}), 
                            // determines how data will be sent
                            headers: {'Content-Type': 'application/json'}, 
                        })
                    </code>
                </pre>
            </div>
            <p class="sectionHeader">Reading</p>
            <p class="sectionContent">Reading is used to get data from the database. Below is an example of a read function:</p>
            <div class="codeCont">
                <pre>
                    <code class="sectionContent codeSection language-js">
                        // importing the schema to allow us to interact with the MongoDB database using mongoose
                        const User = require('../models/person');
                        // importing router to be able to define which URLs will call which functions
                        const router = express.Router();

                        // function to get all data from the Database
                        router.get('/', async(req,res)=>{
                            try {
                                // gets the list of parameters based on the URL that is fetched from the JS code
                                let {userID} = req.params;
                                // searches the User variable for a piece of data that matches what is specified in the curly braces
                                // findOne() returns the first piece of data that matches its search
                                let person = await User.findOne({userID: userID});
                                // returns the data in a response object
                                res.json(person);
                            }catch(error){
                                console.log(error);
                            }
                        })
                    </code>
                </pre>
            </div>
            <p class="sectionContent">Below is an exmaple of calling the read function through a fetch request:</p>
            <div class="codeCont">
                <pre>
                    <code class="sectionContent codeSection language-js">
                        // gets the data and then turns it into a readable format
                        const data = await fetch('/people').then(response=>{
                            return response.json();
                        });
                    </code>
                </pre>
            </div>
            <p class="sectionHeader">Updating</p>
            <p class="sectionContent">Updating is used to update the information of data in the database. Below is an example of an update function:</p>
            <div class="codeCont">
                <pre>
                    <code class="sectionContent codeSection language-js">
                        // importing the schema to allow us to interact with the MongoDB database using mongoose
                        const User = require('../models/person');
                        // importing router to be able to define which URLs will call which functions
                        const router = express.Router();

                        // put function for update people
                        router.put('/:userID', async(req,res)=>{
                            try {
                                // gets the parameter from the fetched URL
                                let {userID} = req.params;
                                // gets the updated info from the body of the fetch request
                                let {routines} = req.body;
                                // gets the user based on the parameter
                                let changePerson = User.findOne({userID});
                                // auto assigns the routine variable if there is no data in it
                                if(!routines){
                                    routines = changePerson.routines;
                                }
                                
                                // findOneAndUpdate() will take two sets of data
                                // the first piece of data will determine what to search for
                                // the second piece of data will determine what to updatein the found data
                                let people = await User.findOneAndUpdate({userID:userID}, {routines:routines});
                                // returns the data in a response object
                                res.json(people);
                            } catch (error) {
                                console.log(error);
                            }
                        })
                    </code>
                </pre>
            </div>
            <p class="sectionContent">Below is an exmaple of calling the update function through a PUT fetch request:</p>
            <div class="codeCont">
                <pre>
                    <code class="sectionContent codeSection language-js">
                        // passes a parameter in the URL that will be used to identify which user is being searched for
                        await fetch(`/people/${currentUser.userID}`, {
                            // determines the type of method that will be used
                            method: "PUT", 
                            // determines how data will be sent
                            headers: {'Content-Type': 'application/json'}, 
                            //passes information into the body of the request that will be used to update data
                            body: JSON.stringify({routines:routines}), 
                        })
                    </code>
                </pre>
            </div>
            <p class="sectionHeader">Deleting</p>
            <p class="sectionContent">Deleting is used to delete data from the database. Below is an example of a delete function:</p>
            <div class="codeCont">
                <pre>
                    <code class="sectionContent codeSection language-js">
                        // importing the schema to allow us to interact with the MongoDB database using mongoose
                        const User = require('../models/person');
                        // importing router to be able to define which URLs will call which functions
                        const router = express.Router();

                        // delete function for delete people
                        // the ":" signifies a parameter in the URL
                        router.delete('/:userID', async(req,res)=>{
                            try {
                                // gets the parameter from the URL
                                const {userID} = req.params;
                                // finds the peice of data that matches the parameter and deletes it from the database
                                let person = await User.findOneAndDelete({userID:userID});
                                // returns the data in a response object
                                res.json(person);
                            } catch (error) {
                                console.log(error);
                            }
                        })
                    </code>
                </pre>
            </div>
            <p class="sectionContent">Below is an exmaple of calling the delete function through a DELETE fetch request:</p>
            <div class="codeCont">
                <pre>
                    <code class="sectionContent codeSection language-js">
                        // passes a parameter in the URL that will be used to identify which user is being searched for
                        await fetch(`/people/${currentUser.userID}`, {
                            // determines the type of method that will be used
                            method: "DELETE",
                            // determines how data will be sent
                            headers: {'Content-Type': 'application/json'}, 
                        })
                    </code>
                </pre>
            </div>
        </div>
    </main>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
    <script src="tutorial.js"></script>
    <script src="./logout.js"></script>
<script src="https://kit.fontawesome.com/b45185f8d5.js" crossorigin="anonymous"></script>

</body>

</html>